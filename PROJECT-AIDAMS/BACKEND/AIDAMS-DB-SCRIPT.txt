CREATE TABLE ACCOUNT (
ACC_ID INT NOT NULL,
ACC_FNAME VARCHAR(50) NOT NULL,
ACC_MNAME VARCHAR(50) NOT NULL,
ACC_LNAME VARCHAR(50) NOT NULL,
ACC_PASSWORD VARCHAR(50) NOT NULL,
ACC_PROFILE BYTEA,
ACC_CONTACT VARCHAR(11) NOT NULL,
ACC_EMAIL VARCHAR(50) NOT NULL,
ACC_TYPE VARCHAR(20) DEFAULT 'USER',
ACC_STATUS VARCHAR(20) DEFAULT 'ACTIVE',
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (ACC_ID)
);


CREATE TABLE DEVICE(
DV_ID INT NOT NULL,
DV_NAME VARCHAR(50) NOT NULL,
DV_KEY VARCHAR(20) NOT NULL,
DV_PASSWORD VARCHAR(50) NOT NULL,
DV_STATUS BOOL DEFAULT 'TRUE',
DV_AUTO_LOCK BOOL DEFAULT 'FALSE',
DV_CURFEW BOOL DEFAULT 'FALSE',
DV_AUTO_LOCK_TIME INT DEFAULT 15,
DV_CURFEW_TIME TIME DEFAULT '11:00:00',
DATE_CREATED DATE DEFAULT TIMESTAMP,
DATE_UPDATED TIME_STAMP DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (DV_ID),
ACC_ID INT,
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE
);

CREATE TABLE BLOC (
BLC_ID INT NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT UNIQUE,
PRIMARY KEY (BLC_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE
);

CREATE TABLE BLC_MEMBER (
BM_ID INT NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT NOT NULL,
BLC_ID INT NOT NULL,
PRIMARY KEY (BM_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE,
FOREIGN KEY (BLC_ID) REFERENCES BLOC ON UPDATE CASCADE
);

CREATE TABLE ACCESS (
ACS_ID INT NOT NULL,
IS_PERMITTED BOOL DEFAULT 'TRUE',
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
BM_ID INT NOT NULL,
DV_ID INT NOT NULL,
PRIMARY KEY (ACS_ID),
FOREIGN KEY (BM_ID) REFERENCES BLC_MEMBER ON UPDATE CASCADE,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);

CREATE TABLE HISTORY (
HIS_ID INT NOT NULL,
HIS_DV_STATUS BOOL DEFAULT 'TRUE',
DATE_CREATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT NOT NULL,
DV_ID INT NOT NULL,
PRIMARY KEY (HIS_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);

CREATE TABLE NOTIFICATION (
NTF_ID INT NOT NULL,
NTF_TYPE VARCHAR(20) NOT NULL,
NTF_MESSAGE VARCHAR(50) NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
DV_ID INT NOT NULL,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);

Query
ALTER TABLE DEVICE
ALTER COLUMN DV_KEY SET DATA TYPE VARCHAR(20),
ALTER COLUMN DV_KEY SET NOT NULL;

INSERT INTO ACCOUNT (acc_fname, acc_mname, acc_lname, acc_email, acc_contact , acc_password ) VALUES ( 'louie jay', 'landiza','natividad','louie@gmail.com', '09324256891' , '12345678');

INSERT INTO DEVICE (DV_NAME, DV_KEY, DV_PASSWORD) VALUES ('TEST DEVICE','ABCD123','ABCD123');

ALTER TABLE HISTORY
ALTER COLUMN DATE_CREATED SET DATA TYPE TIMESTAMP,
ALTER COLUMN DATE_CREATED SET DEFAULT CURRENT_TIMESTAMP;
