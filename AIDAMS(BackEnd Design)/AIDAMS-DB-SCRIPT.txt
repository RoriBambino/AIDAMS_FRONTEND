CREATE TABLE ACCOUNT (
ACC_ID INT NOT NULL,
ACC_FNAME VARCHAR(50) NOT NULL,
ACC_MNAME VARCHAR(50) NOT NULL,
ACC_LNAME VARCHAR(50) NOT NULL,
ACC_PASSWORD VARCHAR(50) NOT NULL,
ACC_PROFILE BYTEA NOT NULL,
ACC_CONTACT INT NOT NULL,
ACC_EMAIL VARCHAR(50) NOT NULL,
ACC_TYPE VARCHAR(20) DEFAULT 'USER',
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (ACC_ID)
);


CREATE TABLE DEVICE(
DV_ID INT NOT NULL,
DV_NAME VARCHAR(50) NOT NULL,
DV_KEY INT NOT NULL,
DV_PASSWORD VARCHAR(50) NOT NULL,
DV_STATUS VARCHAR(20) NOT NULL,
DV_AUTO_LOCK BOOL DEFAULT 'TRUE',
DV_CURFEW_MODE BOOL DEFAULT 'TRUE',
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (DV_ID),
ACC_ID INT NOT NULL,
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE
);

CREATE TABLE BLOC (
BLC_ID INT NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT NOT NULL UNIQUE,
PRIMARY KEY (BLC_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE
);

CREATE TABLE BLC_MEMBER (
BM_ID INT NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT NOT NULL,
BLC_ID INT NOT NULL,
PRIMARY KEY (BM_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE,
FOREIGN KEY (BLC_ID) REFERENCES BLOC ON UPDATE CASCADE
);

CREATE TABLE ACCESS (
ACS_ID INT NOT NULL,
IS_PERMITTED BOOL DEFAULT 'TRUE',
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
BM_ID INT NOT NULL,
DV_ID INT NOT NULL,
PRIMARY KEY (ACS_ID),
FOREIGN KEY (BM_ID) REFERENCES BLC_MEMBER ON UPDATE CASCADE,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);

CREATE TABLE HISTORY (
HIS_ID INT NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
ACC_ID INT NOT NULL,
DV_ID INT NOT NULL,
PRIMARY KEY (HIS_ID),
FOREIGN KEY (ACC_ID) REFERENCES ACCOUNT ON UPDATE CASCADE,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);

CREATE TABLE NOTIFICATION (
NTF_ID INT NOT NULL,
NTF_TYPE VARCHAR(20) NOT NULL,
NTF_MESSAGE VARCHAR(50) NOT NULL,
DATE_CREATED DATE DEFAULT CURRENT_TIMESTAMP,
DATE_UPDATED DATE DEFAULT CURRENT_TIMESTAMP,
DV_ID INT NOT NULL,
FOREIGN KEY (DV_ID) REFERENCES DEVICE ON UPDATE CASCADE
);